<html>
  <head>
    <meta charset="utf-8"/>
    <script src="https://cdn.jsdelivr.net/npm/ruby-head-wasm-wasi@next/dist/browser.script.iife.js"></script>
    <script type="text/ruby"  src="fetch_assets.rb" data-eval="async"></script>
    <script type="text/ruby" src="victor.rb" data-eval="async"></script>
    <script type="text/ruby" src="main.rb"></script>
  </head>
  <body style="margin: 2rem;">
    <textarea id="script-wave" rows="20" style="width: 600px;">
def generate_sample_data(num_samples, frequency, max_amplitude)
  position_in_period = 0.0
  position_in_period_delta = frequency / SAMPLE_RATE

  samples = [].fill(0.0, 0, num_samples)

  num_samples.times do |i|
    samples[i] += ((position_in_period >= 0.5) ? max_amplitude : -max_amplitude) * 1.0
    # samples[i] += (Math::sin(position_in_period * TWO_PI) * max_amplitude) * 1.0
    # samples[i] += (((position_in_period * 2.0) - 1.0) * max_amplitude) * 1.0
    # samples[i] += (max_amplitude - (((position_in_period * 2.0) - 1.0) * max_amplitude * 2.0).abs) * 1.0

    position_in_period += position_in_period_delta

    # 0.0 → 1.0 の周期を繰り返す
    if position_in_period >= 1.0
      position_in_period -= 1.0
    end
  end

  samples
end
    </textarea>
    <br>
    <input type="button" id="gen" value="Generate"></input>
    <input type="button" id="play" value="Test"></input>
    <br>
    <svg id="plot-wave" width="441" height="320"></svg>
    <br>
    <svg id="dummy" width="441" height="480"></svg>
  </body>
</html>
